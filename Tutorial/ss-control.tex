%======================================================================
\NEWSEC
%======================================================================

\subsection{\ssControl}

\begin{frame}[fragile,label=ss-control] 
\secframetitle{\ssControl}

\bluebf{Simulation evolution is controlled in} \bluecode{control\_charm.cpp}

\tikzstyle{decision} = [diamond, draw, fill=blue!20, 
    text width=4.5em, text badly centered, node distance=3cm, inner sep=0pt]
\tikzstyle{block} = [rectangle, draw, fill=blue!20, 
    text width=5em, text centered, rounded corners, minimum height=4em]
\tikzstyle{line} = [draw, -latex']
\tikzstyle{cloud} = [draw, ellipse,fill=red!20, node distance=3cm,
    minimum height=2em]
\ \\
\begin{tikzpicture}[node distance = 3cm, auto]
   \node [block] (init) {Initialize};
   \node [block,below of=init, node distance = 2cm] (adapt) {Adapt};
   \node [block,right of=adapt] (output) {Output};
   \node [block,right of=output] (stopping) {Stopping criteria};
   \node [block,right of=stopping] (compute) {Compute}; 
   \node [block, above of=compute, node distance = 2cm] (refresh) {Refresh};
   \node [coordinate, below of=compute, node distance = 1.5cm] (computenode) {};
   \node [coordinate, below of=adapt, node distance = 1.5cm] (adaptnode) {};

   \path [line] (init) -- (adapt);   
   \path [line] (adapt) -- (output);   
   \path [line] (output) -- (stopping);   
   \path [line] (stopping) -- (compute);   
   \path [line] (compute) -- (refresh);   
   \path [line] (refresh) -- (compute);   
%   \path [line] (compute) -- (adapt);   
 \path [line] (compute.south) -|  (computenode) -- (adaptnode) |- (adapt.south);
\end{tikzpicture}

\end{frame}

